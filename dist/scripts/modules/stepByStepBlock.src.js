import{elementIsExistWithLog}from"./general.js";export default class StepByStepBlock{constructor(t){if(!!elementIsExistWithLog("StepByStep",t.stepsContainerSelector,t.nextButtonsSelector,t.prevButtonsSelector)){this.stepsContainer=document.querySelector(t.stepsContainerSelector),this.stepBlocks=this.stepsContainer.children,this.currentActiveBlockIndex=0,this.currentTranslateMultipler=this.currentActiveBlockIndex,this.transitionTimeout=t.transitionTimeout?t.transitionTimeout:500,this.gapPercent=t.gapPercent?t.gapPercent:5,this.statusBlocksSelector=document.querySelectorAll(t.statusBlocksSelector),this.nextButtons=document.querySelectorAll(t.nextButtonsSelector),this.prevButtons=document.querySelectorAll(t.prevButtonsSelector),this.stepsContainer.style.display="flex",this.stepsContainer.style.flexFlow="row nowrap",this.stepsContainer.style.overflowX="hidden";for(let e of this.stepBlocks)e.style.transition=`transform ${this.transitionTimeout}ms ease`;for(let e of this.nextButtons)e.addEventListener("click",this.toggleNextFormBlock.bind(this));for(let e of this.prevButtons)e.addEventListener("click",this.togglePrevFormBlock.bind(this));t.statusBlocksSelector&&this.statusBlocksSelector[this.currentActiveBlockIndex].classList.add("active"),this.initFormBlocksRow()}}initFormBlocksRow(){let t=this.stepBlocks[this.currentActiveBlockIndex],e=this.stepBlocks[this.currentActiveBlockIndex+1];e!=null&&(t.style.transform="translateX(0%)",e.style.transform=`translateX(${this.gapPercent}%)`)}toggleNextFormBlock(){let t=this.getActiveBlock(),e=this.getSecondBlock(!1),r=this.getThriedBlock(!1),n=this.statusBlocksSelector[this.currentActiveBlockIndex+1];e!=null&&(this.currentTranslateMultipler+=1,t.style.transform=`translateX(-${this.currentTranslateMultipler*100+this.gapPercent}%)`,n&&n.classList.add("active"),this.currentActiveBlockIndex+=1,e.style.transform=`translateX(-${this.currentTranslateMultipler*100}%)`,r&&(r.style.transform=`translateX(-${this.currentTranslateMultipler*100-this.gapPercent}%)`))}togglePrevFormBlock(){let t=this.getActiveBlock(),e=this.getSecondBlock(!0),r=this.getThriedBlock(!0),n=this.statusBlocksSelector[this.currentActiveBlockIndex];if(e==null)return;this.currentTranslateMultipler-=1;let s=this.currentTranslateMultipler*100-this.gapPercent;s<0?(s=this.gapPercent,t.style.transform=`translateX(${s}%)`):t.style.transform=`translateX(-${s}%)`,n&&n.classList.remove("active"),this.currentActiveBlockIndex-=1,e.style.transform=`translateX(-${this.currentTranslateMultipler*100}%)`,r&&(r.style.transform=`translateX(-${this.currentTranslateMultipler*100+this.gapPercent}%)`)}getActiveBlock(){return this.stepBlocks[this.currentActiveBlockIndex]}getSecondBlock(prevOrNextElement){let multipler=this.returnMultipler(prevOrNextElement),prevElement=this.stepBlocks[eval(`${this.currentActiveBlockIndex} ${multipler} 1`)];return prevElement}getThriedBlock(prevOrNextElement){let multipler=this.returnMultipler(prevOrNextElement),beforePrevElement=this.stepBlocks[eval(`${this.currentActiveBlockIndex} ${multipler} 2`)];return beforePrevElement}returnMultipler(t){return t?"-":"+"}}
